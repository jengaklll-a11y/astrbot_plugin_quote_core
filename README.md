# quotes

一个 AstrBot 插件（以下示例假设指令前缀为 `/`，如有修改请替换为自己的前缀）：
- 上传语录：在“回复某人的消息”时发送 `/上传`（可附带图片）。图片将按群分目录保存到 `data/quotes/images/<群号>/`；私聊为 `data/quotes/images/private_<发送者QQ>/`。上传时应在指令后面 `@某人` 指定图片语录归属，例如：`/上传 @语录提供者`；不 @ 则默认归属上传者。注意：必须先写指令（如 `/上传`），再在后面 `@群友`，`@群友 /上传` 这样的写法不会被识别为上传指令。
- 随机语录：发送 `/语录`；
  - 可选：`/语录 @某人` 或 `指令前缀+语录 12345678` 仅随机该用户的语录（按 QQ 号匹配）。
  - 若该语录含用户上传图片，将直接发送原图；否则渲染文本语录图（强制显示头像，使用 qlogo）。
- 删除语录：在“回复机器人刚发送的随机语录消息”时发送 `/删除`（或 `/删除语录`），即可删除该语录。

配置
- global_mode：是否开启“全局模式”。开启后随机语录在所有群/私聊范围内共享；关闭则各群/会话互相隔离（默认）。
- delete_permission：删除语录指令的权限组，字符串枚举值为 `群员`、`管理员`、`群主`、`Bot管理员`。其中：
  - `群员`：所有人可使用删除语录指令；
  - `管理员`：仅群管理员、群主以及 AstrBot 配置中的 Bot 管理员可用；
  - `群主`：仅群主以及 Bot 管理员可用；
  - `Bot管理员`：仅 AstrBot 配置中的 Bot 管理员（`admins_id` 列表）可用。
- blacklist：语录黑名单 QQ 号配置，类型为 `list`，每个元素为一个 QQ 号字符串（仅数字）。例如 `["123456789", "987654321"]`。被加入黑名单的用户不会再新增语录记录（包括使用“上传 QQ号/@”的指令）。旧版本文本配置会被保留兼容解析。
- avatar.provider：`qlogo`（默认）或 `platform`
- image：图像样式（宽高/背景色/文字色/字体等）

数据持久化于 AstrBot 根目录：
- 文本：`data/quotes/quotes.json`
- 图片：`data/quotes/images/*`（按群分目录）

Napcat/OneBot 平台默认使用 qlogo 头像；也可在配置中改为 platform。

依赖：
- `httpx`（下载远程图片）

版本
- v1.0.0
